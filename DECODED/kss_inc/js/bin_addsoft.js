	function loadsoft2ui(softmode_2){		if(softmode_2==1){			$(".chkonlineset,.chionlineset_,.unbindpc_,.unbindpc_set").hide();		}else{			$(".chkonlineset,.chionlineset_,.unbindpc_,.unbindpc_set").show();			loadlineui($("#chkonline").attr("checked"));		}	}	function loadlineui(chk_online){		if(chk_online==1){			$(".chkonlineset").show();			$(".unbindpc_,.unbindpc_set").hide();		}else{			$(".chkonlineset").hide();			$(".unbindpc_,.unbindpc_set").show();					loadbindui($("#unbindpc_set").val());		}	}	function loadsoftui(v_softmode){		if(v_softmode=="USOFT"){			$("#softstatus").html($("#ustatus").html());			$("[tbtid='18']").show();		}else{			$("#softstatus").html($("#kstatus").html());			$("[tbtid='18']").hide();		}	}		function loadbindui(v_unbindpc_set){		if(v_unbindpc_set==0){			$(".unbindpc_set").hide();			$("#unbindtext").text("客户端界面无需解绑按钮");		}else{			$(".unbindpc_set").show();			if(v_unbindpc_set==2){				$("#canautounbind").show();				$("#unbindtext").text("客户端界面无需解绑按钮");			}else{				if(v_unbindpc_set==3){					$("#canautounbind").show();					}else{					$("#canautounbind").hide();					}								$("#unbindtext").text("需要客户通过点击客户端界面解绑按钮");					}		}	}		$(document).ready(function() {         var oldadvapival=$("#advapivv").val();		//#绑定需提交的表单		$('#admin_addsoftrrrrr').ajaxForm({			beforeSubmit:function (arr, $form, options) { 				return true;			},			success:function (responseText, statusText, xhr, $form) {				malert(responseText); 				if(responseText.indexOf("添加软件成功")!=-1) {					$("#softname").attr("value","未命名软件"+randstr(4));					$("#softkey").attr("value",randstr(24));				}			}		});		$("#advapilib").bind("dblclick",function(){            alert("调试模式");            $("#advapilib2").show();        });		$("#softsubmit").click(function () {            //var c=CKEDITOR.instances;            //alert(c['mailtext'].getData());            for ( instance in CKEDITOR.instances ) {                CKEDITOR.instances[instance].updateElement();            }            //$("from").serialize();            if($("#debugmode").val()==1)return true;            if(($("#softid").val()==0 || oldadvapival!=$("#advapivv").val() ) && $("#softsyspassword").val()=='' ){                                var pwdinputids='c'+parseInt(Math.random()*999999+100000).toString();                malert('添加软件或修改软件advapi代码时需要效验安全接口密码<br>请输入安全接口密码：<input id='+pwdinputids+' type=password value=\'\'><br>','请输入安全接口密码',500,60,                function(){                    $("#softsyspassword").val($('#'+pwdinputids).val());                    var options = {                        url: $("#admin_addsoft").attr("action"),                        type: 'post',                        dataType: 'text',                        data: $("#admin_addsoft").serialize(),                        success: function (responseText) {                            malert(responseText);                             if(responseText.indexOf("接口密码错误")!=-1)$("#softsyspassword").val("");                            if(responseText.indexOf("添加软件成功")!=-1) {                                $("#softname").attr("value","未命名软件"+randstr(4));                                $("#softkey").attr("value",randstr(24));                            }                        },                        error: function(XMLHttpRequest, textStatus, errorThrown) {                            alert("error:"+XMLHttpRequest.status+","+XMLHttpRequest.readyState+","+textStatus);                        }                    };                    $.ajax(options);                 },"addsoft");            }else{                var options = {                    url: $("#admin_addsoft").attr("action"),                    type: 'post',                    dataType: 'text',                    data: $("#admin_addsoft").serialize(),                    success: function (responseText) {                        malert(responseText);                         if(responseText.indexOf("添加软件成功")!=-1) {                            $("#softname").attr("value","未命名软件"+randstr(4));                            $("#softkey").attr("value",randstr(24));                        }                    },                    error: function(XMLHttpRequest, textStatus, errorThrown) {                        alert("error:"+XMLHttpRequest.status+","+XMLHttpRequest.readyState+","+textStatus);                    }                };                $.ajax(options);                        }            return false;        });		$("[name='softmode']").bind("click",function(){			loadsoftui($(this).val());		});				$("[name='unbindpc_set']").bind("change",function(){			loadbindui($(this).val());		});		$("#chkonline").bind("click",function(){			loadlineui($(this).attr("checked"));		});		$("#softmode2").bind("click",function(){			loadsoft2ui($(this).attr("checked"));		});		$("#tabs01").ksstabs();		loadsoftui(softmode);		loadsoft2ui(softmode2); 				$("#tmpopadd").bind("click",function(){		var _k,_i,_n,_d,_p,_c;		_k=$("#tmpopkeyfix").val();			_n=$("#tmpop_num").val();		_d=$("#tmpop_day").val();		_p=$("#tmpop_points").val();			_i=0;				if( $("[g='g"+_k+_n+"']").length >0 ){			malert("该卡类型对应的张数设置赠送天数点数已存在，不要重复设置。");			return true;		}		//计算i的值				for(var i=0;i< 10;i++) {			if( $("#tr"+_k+i).length < 1 ){				_i=i;				break;			}			}		if(_p==0 && _d==0){			malert("赠送的天数和点数不能都设置为【0】");			return true;		}		addczset(_k,_i,_n,_d,_p);	});	$("[delczzs]").live("click",function(){		_trid=$(this).attr("delczzs");		$("#"+_trid).remove();	});					$("#tmpopadd2").bind("click",function(){		var _k,_c,_d,_p,_d2,_p2;		_k=$("#tmpopkeyfix2").val();		_c=$("#tmpop_cj").val();		_d=$("#tmpop_day1").val();		_p=$("#tmpop_points1").val();		_d2=$("#tmpop_day2").val();		_p2=$("#tmpop_points2").val();				if( $("#ttr"+_k).length >0 ){			malert("该卡类型已在设置里。");			return true;		}		if(_p==0 && _d==0 && _p2==0 && _d2==0){			malert("赠送的天数和点数不能都设置为【0】");			return true;		}				addtgset(_k,_c,_d,_p,_d2,_p2);	});	});function addtgset(k,c,d,p,d2,p2){	var tbs='';	tbs=tbs+'<tr class=trd id="ttr'+k+'" ><td>'+$("#tmpopkeyfix2").find("option:selected").text()+'</td><td>';	tbs=tbs+'<select name="zs_tgset['+k+'][cj]" >';	tbs=tbs+'<option value=1';	if(c==1)tbs=tbs+' selected';	tbs=tbs+'>只在注册时赠送</option>';	tbs=tbs+'<option value=2';	if(c==2)tbs=tbs+' selected';	tbs=tbs+'>注册和充值都赠送</option></select></td>';	tbs=tbs+'<td><input type="text" class="sml2input" maxlength="5" name="zs_tgset['+k+'][zsday1]" value="'+d+'" onkeyup="this.value=this.value.replace(/[^0-9\.]/g, \'\')"></td>';	tbs=tbs+'<td><input type="text" class="smlinput" maxlength="5" name="zs_tgset['+k+'][zspoints1]" value="'+p+'" onkeyup="this.value=this.value.replace(/\\D/g, \'\')"></td>';	tbs=tbs+'<td><input type="text" class="sml2input" maxlength="5" name="zs_tgset['+k+'][zsday2]" value="'+d2+'" onkeyup="this.value=this.value.replace(/[^0-9\.]/g, \'\')"></td>';	tbs=tbs+'<td><input type="text" class="smlinput" maxlength="5" name="zs_tgset['+k+'][zspoints2]" value="'+p2+'" onkeyup="this.value=this.value.replace(/\\D/g, \'\')"></td>';	tbs=tbs+'<td><img src="../kss_inc/images/b_drop.png" delczzs="ttr'+k+'"  malt="删除该推广增送设置" style="cursor:hand"></td></tr>';	$("#tmpoparea2").before(tbs);}function addczset(k,i,n,d,p){	var tbs='';	tbs=tbs+'<tr class=trd id="tr'+k+i+'" g="g'+k+n+'" ><td>'+$("#tmpopkeyfix").find("option:selected").text()+'</td><td><input  maxlength="1" type="text" class="sml2input" name="zs_czset['+k+']['+i+'][num]" value="'+n+'" onkeyup="this.value=this.value.replace(/[^1-5]/g, \'\')"></td>';	tbs=tbs+'<td><input type="text"  maxlength="5" class="sml2input" name="zs_czset['+k+']['+i+'][zsday]" value="'+d+'" AUTOCOMPLETE="off" onkeyup="this.value=this.value.replace(/[^0-9\.]/g, \'\')"></td>';	tbs=tbs+'<td><input type="text"  maxlength="5" class="smlinput" name="zs_czset['+k+']['+i+'][zspoints]" value="'+p+'" AUTOCOMPLETE="off" onkeyup="this.value=this.value.replace(/\\D/g, \'\')"></td>';	tbs=tbs+'<td><img src="../kss_inc/images/b_drop.png" delczzs="tr'+k+i+'"  malt="删除该赠送设置" style="cursor:hand"></td></tr>';	$("#tmpoparea").before(tbs);	// alert(tbs);	}